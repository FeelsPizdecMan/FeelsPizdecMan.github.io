//Template Name: hrew a production constructions KPK-Consent
jQuery(document).ready(function(){
	var toplg = jQuery('#toplg');
	var header = jQuery('header');
	var page = jQuery('#page');
	jQuery(window).scroll(function(){
		if ( jQuery(this).scrollTop() > 118 && header.hasClass('hd-normal') ){
			toplg.hide();
			page.css('padding-top','168px');
			header.removeClass('hd-normal').addClass('hd-fix');
		}
		else if(jQuery(this).scrollTop() <= 118 && header.hasClass('hd-fix')) {
			header.removeClass('hd-fix').addClass('hd-normal');
			page.css('padding-top','0px');
			toplg.show();
		}
	});
	
	jQuery('.topsocial a').on('click', function(event) {
		var href = jQuery(this).attr('href');
		event.preventDefault();
		window.open(href, '_blank').focus();
	});
//Сбережения [МинСрок,МаксСрок, Процент,МинСумма, МаксСумма ]
	var selvk = [
		[12,12,15.2,1000,1500000],
		[7,10,13,3000,800000],
		[3,6,11,20000,500000],
		[12,12,15.7,500,1000000],
		[12,12,13.5,5000,500000],
		[12,12,13,10000,1000000],
		[12,12,7,1000,500000],
	];	
//Займ [МинСрок,МаксСрок, Процент,МинСумма, МаксСумма ]	
	var selsb = [
		[12,24,16.3,30000,1000000],
		[6,24,18,5000,1000000],
		[0.5,0.5,100,1000,30000],
		[12,36,18,100000,15000000],
		[6,6,19,30000,30000],
		[6,6,20,1000,10000],
		[60,60,14,300000,1000000],
		[12,12,8,453026,453026],
		[12,12,8,500000,600000],
		[12,12,8,500000,1600000],
	];	
	try {
		jQuery.browserSelector();
		if(jQuery("html").hasClass("chrome")) { jQuery.smoothScroll();}
		} catch(err) {
	}
	setTimeout(function() { jQuery('#exposeMask').remove(); }, 1000);
	
	jQuery(function(){
   	jQuery(".telefone").mask("+7 (999) 999-9999");
		jQuery("#seria").mask("99 99");
		jQuery("#number").mask("999999");
	});
	jQuery('#nam_sb').val(0);
	jQuery('#nam_sb').change(function(){
		var sb = +jQuery('#nam_sb').val();
		var stmin = selsb[sb][3];
		var stmax = selsb[sb][4];
		var stpmin = selsb[sb][0];		
		var stpmax = selsb[sb][1];
		var stpro = selsb[sb][2];
		jQuery('#summa-line').attr('min',stmin).attr('max',stmax).attr('value',stmin*3).attr('step',stmin);
		jQuery('#summa-txt').attr('max',stmax).attr('value',stmin*3);
		
		jQuery('#srok-line').attr('min',stpmin).attr('max',stpmax);
		if (stpmin === stpmax){
			jQuery('#srok-line').attr('value',stpmax).attr('step',stpmax);
			jQuery('#srok-txt').attr('max',stpmax).attr('value',stpmax);
		} else {
			jQuery('#srok-line').attr('value',stpmin+2).attr('step',1);
			jQuery('#srok-txt').attr('max',stpmax).attr('value',stpmin+2);	
		}
		jQuery('.cen-txt b').text(stpro);
		jQuery('.min-sim_txt p').text(stmin);
		jQuery('.mix-sim_txt p').text(stmax);
		jQuery('.min_sim_txt p').text(stpmin);
		jQuery('.mix_sim_txt p').text(stpmax);
		jQuery('#summa-txt').val(jQuery('#summa-line').val());
		jQuery('.sum-txt p').text(jQuery('#summa-line').val());
		var vpro = +jQuery('.cen-txt b').text() / 100 / 12; // процент
		var vsrok = +jQuery('#srok-txt').val();
		var sum = +jQuery('#summa-txt').val();
		var vsumm =  Math.round(sum * (vpro + vpro / ( Math.pow( vpro + 1, vsrok ) - 1) )); // сумма
		var vsumma = sum + vsumm * vsrok - sum;
		
		jQuery('.cent_txt p > span').text(vsumma);
		
	});
	
	jQuery('#summa-txt').val(jQuery('#summa-line').val());
	jQuery('.sum-txt p').text(jQuery('#summa-line').val());
	jQuery('#summa-line').mousemove(function() {
		jQuery('#summa-txt').val(jQuery('#summa-line').val());
		jQuery('.sum-txt p').text(jQuery('#summa-line').val());
		var vpro = +jQuery('.cen-txt b').text() / 100 / 12; // процент
		var vsrok = +jQuery('#srok-txt').val();
		var sum = +jQuery('#summa-txt').val();
		var vsumm =  Math.round(sum * (vpro + vpro / ( Math.pow( vpro + 1, vsrok ) - 1) )); // сумма
		var vsumma = sum + vsumm * vsrok - sum;
		jQuery('.cent_txt p > span').text(vsumma);				
	});
	
	jQuery('#srok-txt').val(jQuery('#srok-line').val());
	jQuery('#srok-line').mousemove(function() {
		jQuery('#srok-txt').val(jQuery('#srok-line').val());
		var vpro = +jQuery('.cen-txt b').text() / 100 / 12; // процент
		var vsrok = +jQuery('#srok-txt').val();
		var sum = +jQuery('#summa-txt').val();
		var vsumm =  Math.round(sum * (vpro + vpro / ( Math.pow( vpro + 1, vsrok ) - 1) )); // сумма
		var vsumma = sum + vsumm * vsrok - sum;
		
		jQuery('.cent_txt p > span').text(vsumma);
	});
	
	jQuery('#summa-txt').change(function() {
		jQuery('#summa-line').val(jQuery('#summa-txt').val());
		jQuery('#summa-line').text(jQuery('#summa-txt').val());
		var vpro = +jQuery('.cen-txt b').text() / 100 / 12; // процент
		var vsrok = +jQuery('#srok-txt').val();
		var sum = +jQuery('#summa-txt').val();
		var vsumm =  Math.round(sum * (vpro + vpro / ( Math.pow( vpro + 1, vsrok ) - 1) )); // сумма
		var vsumma = sum + vsumm * vsrok - sum;
		
		jQuery('.cent_txt p > span').text(vsumma);
	});
	
	jQuery('#srok-txt').change(function() {
		jQuery('#srok-line').val(jQuery('#srok-txt').val());
		var vpro = +jQuery('.cen-txt b').text() / 100 / 12; // процент
		var vsrok = +jQuery('#srok-txt').val();
		var sum = +jQuery('#summa-txt').val();
		var vsumm =  Math.round(sum * (vpro + vpro / ( Math.pow( vpro + 1, vsrok ) - 1) )); // сумма
		var vsumma = sum + vsumm * vsrok - sum;
		
		jQuery('.cent_txt p > span').text(vsumma);
	});
	
//---------------------------------------------
	
	jQuery('#nam_vk').val(0);
	jQuery('#nam_vk').change(function(){
		var st = +jQuery('#nam_vk').val();
		var stmin = selvk[st][3];
		var stmax = selvk[st][4];
		var stpmin = selvk[st][0];		
		var stpmax = selvk[st][1];
		var stpro = selvk[st][2];
		jQuery('#vkad-line').attr('min',stmin).attr('max',stmax).attr('value',stmin*3).attr('step',stmin);
		jQuery('#vkad-text').attr('max',stmax).attr('value',stmin*3);
		
		jQuery('#srok-vklad').attr('min',stpmin).attr('max',stpmax);
		if (stpmin === stpmax){
			jQuery('#srok-vklad').attr('value',stpmax).attr('step',stpmax);
			jQuery('#srokvk-txt').attr('max',stpmax).attr('value',stpmax);
		} else {
			jQuery('#srok-vklad').attr('value',stpmin+2).attr('step',1);
			jQuery('#srokvk-txt').attr('max',stpmax).attr('value',stpmin+2);	
		}
		jQuery('.procent-txt b').text(stpro);
		jQuery('#calck_v .min-sim_txt p').text(stmin);
		jQuery('#calck_v .mix-sim_txt p').text(stmax);
		jQuery('#calck_v .minsim_txt p').text(stpmin);
		jQuery('#calck_v .mixsim_txt p').text(stpmax);		
		jQuery('#vkad-text').val(jQuery('#vkad-line').val());
		jQuery('.sumin-txt p').text(jQuery('#vkad-line').val());
		
		var vpro = +jQuery('.procent-txt b').text() / 12;
		var vsrok = +jQuery('#srokvk-txt').val() * vpro;
		var vsumm =  Math.round(jQuery('#vkad-text').val() / 100 * vsrok);
		var vsumma = +jQuery('#vkad-text').val() + vsumm;	
		
		jQuery('.sumout-txt p').text(vsumma);
		
	});
		
	jQuery('#vkad-text').val(jQuery('#vkad-line').val());
	jQuery('.sumin-txt p').text(jQuery('#vkad-line').val());
	jQuery('#vkad-line').mousemove(function() {
		jQuery('#vkad-text').val(jQuery('#vkad-line').val());
		jQuery('.sumin-txt p').text(jQuery('#vkad-line').val());
		var vpro = +jQuery('.procent-txt b').text() / 12;
		var vsrok = +jQuery('#srokvk-txt').val() * vpro;
		var vsumm =  Math.round(jQuery('#vkad-text').val() / 100 * vsrok);
		var vsumma = +jQuery('#vkad-text').val() + vsumm;	
		jQuery('.sumout-txt p').text(vsumma);				
	});
	
	jQuery('#srokvk-txt').val(jQuery('#srok-vklad').val());
	jQuery('#srok-vklad').mousemove(function() {
		jQuery('#srokvk-txt').val(jQuery('#srok-vklad').val());
		var vpro = +jQuery('.procent-txt b').text() / 12;
		var vsrok = +jQuery('#srokvk-txt').val() * vpro;
		var vsumm =  Math.round(jQuery('#vkad-text').val() / 100 * vsrok);
		var vsumma = +jQuery('#vkad-text').val() + vsumm;	
		jQuery('.sumout-txt p').text(vsumma);		
	});
	
	jQuery('#vkad-text').change(function() {
		jQuery('#vkad-line').val(jQuery('#vkad-text').val());
		jQuery('.sumin-txt p').text(jQuery('#vkad-text').val());
		var vpro = +jQuery('.procent-txt b').text() / 12;
		var vsrok = +jQuery('#srokvk-txt').val() * vpro;
		var vsumm =  Math.round(jQuery('#vkad-text').val() / 100 * vsrok);
		var vsumma = +jQuery('#vkad-text').val() + vsumm;	
		jQuery('.sumout-txt p').text(vsumma);		
	});
	
	jQuery('#srokvk-txt').change(function() {
		jQuery('#srok-vklad').val(jQuery('#srokvk-txt').val());
		var vpro = +jQuery('.procent-txt b').text() / 12;
		var vsrok = +jQuery('#srokvk-txt').val() * vpro;
		var vsumm =  Math.round(jQuery('#vkad-text').val() / 100 * vsrok);
		var vsumma = +jQuery('#vkad-text').val() + vsumm;	
		jQuery('.sumout-txt p').text(vsumma);		
	});
	
	jQuery('#calckul').on('click', function(){
		
		if(jQuery("#calck_v.glav").is(":visible")) {jQuery('#calck_v.glav').slideUp( "fast");}
		jQuery('#calck.glav').slideToggle( "slow");
		
	});
	
	jQuery('#calckul_v').on('click', function(){
		
		if(jQuery("#calck.glav").is(":visible")) {jQuery('#calck.glav').slideUp( "fast");}
		jQuery('#calck_v.glav').slideToggle( "slow");
		
	});	
	jQuery('input[name=time]').on('change', function (){
		if(jQuery('input:radio[name=time]:checked').attr('data-dis') === 'time'){
			jQuery('#time').prop('disabled',false);
		} else{
			jQuery('#time').prop('disabled',true);
		}
	});
	
	jQuery('#chek-add').on('change', function (){
		if (jQuery('#chek-add').is(':checked')) {
				jQuery('#form-pro').collapse("hide");
				jQuery('#point-propiska, #city-propiska, #ulica-propiska, #dom-propiska, #kv-propiska, #cor-propiska, #data-propiska').prop('disabled',true);
				jQuery('#point-propiska, #city-propiska, #ulica-propiska, #dom-propiska, #data-propiska').prop('required',false);
		} else {
				jQuery('#form-pro').collapse("show");
			 	jQuery('#point-propiska, #city-propiska, #ulica-propiska, #dom-propiska, #kv-propiska, #cor-propiska, #data-propiska').prop('disabled',false);
				jQuery('#point-propiska, #city-propiska, #ulica-propiska, #dom-propiska, #data-propiska').prop('required',true);
		}
	});
	
	jQuery('.phone-form').submit(function(){
		var times;
		jQuery('.phone-form').find('button[type="submit"]').attr('disabled','disabled');
		if(jQuery('input:radio[name=time]:checked').attr('data-dis') === 'time'){
			times = jQuery('#time').val();
		} else{
			times = 'Сейчас';
		}		
		jQuery.ajax({
		type: "POST",
		data: ({
			useemail : jQuery('#useremail').val(),
			usename : jQuery('#fio').val(),
			usephone: jQuery('#tel').val(),
			time: times 
		}),
		success: function(msg){
		if(msg === 'ERROR') {
			jQuery('.info_text h4').text('Ошибка передачи данных!');
			jQuery('#infoform').modal("show");
		}else{
		jQuery('.phone-form input[type=text], .phone-form input[type=tel]').val('');
		jQuery('.phone-form input[type=time]').val('20:00');
		jQuery('#callform').modal("hide");
		jQuery('.info_text h4').text('Ваша просьба перезвонить отправлена!');
		jQuery('#infoform').modal("show");
		}}
		});
		jQuery('.phone-form').find('button[type="submit"]').attr('disabled', false);
		return false;
		});
jQuery('.zayavka-form').submit(function(){		
		jQuery.ajax({
		type: "POST",
		data: ({
			useemail : jQuery('#suseremail').val(),
			usename : jQuery('#sfio').val(),
			usephone: jQuery('#stel').val(),
			formtype: 'zayavka'
		}),
		success: function(msg){
		if(msg === 'ERROR') {
			jQuery('.info_text h4').text('Ошибка передачи данных!');
			jQuery('#infoform').modal("show");
		}else{
		jQuery('.zayavka-form input[type=text], .zayavka-form input[type=tel]').val('');
		jQuery('#sendreqform').modal("hide");
		jQuery('.info_text h4').text('Ваша заявка отправлена!');
		jQuery('#infoform').modal("show");
		}}
		});
		jQuery('.zayavka-form').find('button[type="submit"]').attr('disabled', false);
		return false;
		});
	jQuery('.order-form').submit(function(){
		jQuery('.order-form').find('button[type="submit"]').attr('disabled','disabled');
		jQuery.ajax({
		type: "POST",
		url: "",
		data: jQuery('.order-form').serialize(),
		success: function(msg){
		if(msg === 'ERROR') {
			jQuery('.info_text h4').text('Ошибка передачи данных!');
			jQuery('#infoform').modal("show");
		}else{
		jQuery('.order-form input[type=text], .order-form input[type=date]').val('');
		jQuery('#orderform').modal("hide");
		jQuery('.info_text h4').text('Ваша заявка успешно отправлена!');
		jQuery('#infoform').modal("show");
		}}
		});
		jQuery('.order-form').find('button[type="submit"]').attr('disabled', false);
		return false;
		});
	
	jQuery('.quest-form').submit(function(){
		jQuery('.quest-form').find('button[type="submit"]').attr('disabled','disabled');
		jQuery.ajax({
		type: "POST",
		url: "",
		data: jQuery('.quest-form').serialize(),
		success: function(msg){
		if(msg === 'ERROR') {
			jQuery('.info_text h4').text('Ошибка передачи данных!');
			jQuery('#infoform').modal("show");
		}else if(msg === 'errcap'){
			jQuery('#user-cap').val('').removeClass('has-success').addClass('has-error');
			jQuery('.user-but a').trigger('click');
		}else{
			jQuery('.quest-form input[type=text], .quest-form input[type=email], #user-text').val('');
			jQuery('#user-cap').removeClass('has-error').addClass('has-success');
			jQuery('.user-but a').trigger('click');
			jQuery('#orderform').modal("hide");
			jQuery('.info_text h4').text('Ваш вопрос успешно отправлен!');
			jQuery('#infoform').modal("show");
		}}
		});
		jQuery('.quest-form').find('button[type="submit"]').attr('disabled', false);
		return false;
		});		
});